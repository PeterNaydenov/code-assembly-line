var CodeAssemblyLine=function(e){var t={};function r(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(s,o,function(t){return e[t]}.bind(null,o));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=1)}([function(e,t,r){"use strict";const s={notDefined:"Not defined error.",brokenTemplate:"Broken string template. Placeholder with missing closing tag.",wrongDataTemplate:"Broken data template. Object is not according the standards.",overwriteTemplate:"Error: Overwrite of existing template is not permited by configuration.",missingTemplate:'Error: Template "%s" doesn\'t exist.',wrongExtProcess:'Wrong process data. Should be an array of "processSteps".',emptyExtProcess:"Empty process! Process should contain steps(processSteps)",brokenProcess:"Broken process description.",missingOperation:'Process has step with missing operation. Set parameter "do".',overwriteProcess:'Error: Process with name "%s" is already defined.',notaValidOperation:'Error: "%s" is not a valid operation',blockExpectString:"Block expects string data. %s",dataExpectObject:"Data operations require objects. %s",overwriteData:'Error: Data with name "%s" is already defined.',processNotExists:'Error: Process "%s" does not exist.',templateNotExists:'Error: Template "%s" is not available',invalidStorageName:'Error: Process-step "save" has param "as: %s". Param "as" should be "data", "template" or "process". ',invalidJSON:'Error: Invalid JSON format was provided for saving in "processes": %s'};e.exports=function(e,t){let r=s[e]||s.notDefined;return t&&(t instanceof Array||(t=[t]),t.forEach(e=>r=r.replace("%s",e))),r}},function(e,t,r){"use strict";const s=r(0),o=r(2),n=r(3),a=r(4)({chop:o,showError:s}),c=r(5)({showError:s}),i=r(6)({help:c}),l=r(7)({help:c,showError:s,operation:i}),p=r(8)({help:c,showError:s,templateTools:a}),u=r(9)({help:c,showError:s}),d=r(10)({help:c,showError:s,processTools:l}),h={overwriteTemplates:!1,overwriteProcesses:!1,overwriteData:!1,htmlAttributes:["id","name","href","src","value","data","alt","role","class"]};function f(e){this.templates={},this.processes={},this.data={},this.config={},Object.keys(h).forEach(e=>this.config[e]=h[e]),e&&Object.keys(e).forEach(t=>this.config[t]=e[t])}f.prototype={tools:n,insertTemplate:p.insert,insertTemplateLib:p.insertLib,getTemplate:p.get,getTemplateLib:p.getLib,getPlaceholders:p.getPlaceholders,renameTemplate:p.rename,removeTemplate:p.remove,insertProcess:d.insert,insertProcessLib:d.insertLib,mixProcess:d.mix,getProcessLib:d.getLib,getHooks:d.getHooks,run:d.run,renameProcess:d.rename,removeProcess:d.remove,insertData:u.insert,insertDataLib:u.insertLib,getBlock:u.getBlock,getBlocks:u.getBlock,renameData:u.rename,removeData:u.remove},e.exports=f},function(e,t,r){"use strict";const s=r(0);e.exports=function e(t){let r,o,n,a=[];if("string"!=typeof t)return[s("brokenTemplate")];if(0==t.length)return[];if(0<(r=t.indexOf("{{"))&&a.push(t.slice(0,r)),-1==r)return a.push(t),a;{if(n=t.indexOf("{{",r+2),-1==(o=t.indexOf("}}")))return[s("brokenTemplate")];if(o<r)return[s("brokenTemplate")];if(o+=2,-1!=n&&n<o)return[s("brokenTemplate")];a.push(t.slice(r,o));let c=e(t.slice(o));return a.concat(c)}}},function(e,t,r){"use strict";const s={renameTemplate:function(e,t){const r=Object.keys(t);return Object.keys(e).reduce((s,o)=>(r.includes(o)?s[t[o]]=e[o]:s[o]=e[o],s),{})}};e.exports=s},function(e,t,r){"use strict";e.exports=function({chop:e,showError:t}){const r={str2intTemplate(s){const o=e(s),n=o.includes(t("brokenTemplate"));let a={},c={};if(!n){const e=r._findPlaceholdersAndSpaces(o);c=e.spaces,a=e.placeholders}const i={tpl:o,placeholders:a,spaces:c};return n&&(i.errors=[t("brokenTemplate")]),i},load_interpretTemplate:e=>r=>{let s={};return s="string"==("string"==typeof r?"string":"error")?e(r):{errors:[t("wrongDataTemplate")]}},_findPlaceholdersAndSpaces(e){const t={},r={};return e.forEach((e,s)=>{if("{{"==e.slice(0,2)){let o=2,n=-2;const a="~~"==e.slice(2,4),c="~~"==e.slice(-4,-2);a&&(o=4),c&&(n=-4);const i=e.slice(o,n);a&&c?r[i]=3:c?r[i]=2:a&&(r[i]=1),t.hasOwnProperty(i)?t[i].push(s):t[i]=[s]}}),{spaces:r,placeholders:t}}};return r}},function(e,t,r){"use strict";e.exports=function({showError:e}){const t={_isWritingForbidden(e,t,r){let s;return s="templates"==t?"overwriteTemplates":"processes"==t?"overwriteProcesses":"overwriteData",e[t].hasOwnProperty(r)&&!e.config[s]},_validateProcess(t,r){let s=[];const o=t.processes.hasOwnProperty(r),n=t.processes[r];return o&&n.errors&&(s=s.concat(n.errors)),o?n.arguments.reduce((e,t)=>("draw"==t.do&&t.tpl&&e.push(t.tpl),e),[]).forEach(r=>{const o=t.templates[r];o&&o.errors&&(s=s.concat(o.errors)),o||s.push(e("templateNotExists",r))}):s.push(e("processNotExists",r)),s},_extractLib(e,t){const r=Object.keys(e).filter(e=>e.includes("/"));let s={};return t?s=t.reduce((t,s)=>(r.filter(e=>0==e.indexOf(s)).forEach(r=>{const s=r.indexOf("/"),o=r.slice(s+1);t[o]=e[r].tpl.join("")}),t),{}):Object.keys(e).forEach(t=>s[t]=e[t].tpl.join("")),s},_flatten(e,r=[],s={}){let o=Object.assign({},s),n=!1;if(!e){const[t,s]=r.pop();n=t,e=s}for(let s in e){const a=e[s];let c=s;n&&(c=`${n}/${s}`),"function"!=typeof a&&(t._isPrimitive(a)?o[c]=a:r.push([c,a]))}return 0!=r.length?t._flatten(!1,r,o):o},_isPrimitive:e=>"object"!=typeof e};return t}},function(e,t,r){"use strict";e.exports=function({help:e}){const t={draw(r){let{template:s,data:o,sharedData:n,htmlAttributes:a,missField:c,missData:i,hookFn:l}=r,p=[];return o.forEach((r,o)=>{const u=e._flatten(r),d=u?Object.keys(u):[];let h=t._copyList(s.tpl),f=Object.assign({},s.placeholders),m=s.spaces,b="",g="";if(f._attr){const e=f._attr[0];b=m._attr&&m._attr%2?" ":"",g=m._attr&&m._attr>1?" ":"";const r=t._createAttributes(u,a).trim();h[e]=r?`${b}${r}${g}`:"",delete f._attr}if(f._count){const e=f._count;b=m._count&&m._count%2?" ":"",g=m._count&&m._count>1?" ":"",e.forEach(e=>h[e]=`${b}${o+1}${g}`),delete f._count}d.forEach(e=>{const t=f[e];if(b=m[e]&&m[e]%2?" ":"",g=m[e]&&m[e]>1?" ":"",t){for(let r of t)h[r]=`${b}${u[e]}${g}`;delete f[e]}});let k=Object.keys(f),y=k.length>0;if(y&&n)for(let e of k)if(n[e]){const t=f[e];b=m[e]&&m[e]%2?" ":"",g=m[e]&&m[e]>1?" ":"",t.forEach(t=>h[t]=`${b}${n[e]}${g}`),delete f[e]}if((y=(k=Object.keys(f)).length>0)&&c){let e;switch("_fn"==c&&"function"!=typeof l&&(c="_hide"),c){case"_fn":e=l;break;case"_hide":e=(()=>"");break;case"_position":e=(e=>e);break;default:e=(()=>c)}for(let t of k)f[t].forEach(r=>h[r]=e(t))}if(y&&i){let e;switch("_fn"==i&&"function"!=typeof l&&(i="_hide"),i){case"_fn":e=(e=>[l(e)]);break;case"_hide":e=(()=>[]);break;default:e=(()=>[i])}h=e(k)}h.length>0&&p.push(h.join(""))}),p},_createAttributes(e,t){const r={},s=new RegExp("^data-");let o="";for(let n in e)"name"!==n&&("id"!==n?"className"!==n?t.includes(n)?r[n]=`${n}="${e[n]}"`:s.test(n)&&(r[n]=`${n}="${e[n]}"`,o+=` ${r[n]}`):r.class=`class="${e[n]}"`:(r.id=`id="${e[n]}"`,r.name=`name="${e[n]}"`));return t.reduce((e,t)=>(r[t]&&(e+=` ${r[t]}`),"data"==t&&(e+=` ${o}`),e),"")},_copyList:e=>e.map(e=>e),alterTemplate(e,t){const r=e.data,s=Object.keys(t),o={};return s.forEach(e=>{const s=r[e]||e;o[s]=t[e]}),o},block:(e,t)=>[e.join(t)],set(e,t){const r=e.as;return t.reduce((e,t)=>{let s={};return s[r]=t,e.push(s),e},[])},alter(e,r){const s=e.data,o=Object.keys(s),n=t._normalizeSelection(e.select,r.length);let a=r.map(e=>Object.assign({},e));return n.forEach(e=>{const t=a[e],r=Object.keys(t);let n={};r.forEach(e=>{let r=t[e];o.includes(e)&&(e=s[e]),n[e]=r}),a[e]=n}),a},_normalizeSelection(e,r){let s=[];return e?("object"!=typeof e&&(e=[e]),e.forEach(e=>{if("all"==e)return s=t._generateList(r);switch(e){case"first":s.push(0);break;case"last":s.push(r-1);break;default:e<0?s.push(r-1+e):s.push(e-1)}}),s):s=t._generateList(r)},_generateList(e){let t=[];for(let r=0;r<e;r++)t.push(r);return t},add(e,r){const s=e.data,o=Object.keys(s),n=t._normalizeSelection(e.select,r.length);let a=r.map(e=>Object.assign({},e));return n.forEach(e=>{const r=a[e];Object.keys(r);let n=o.reduce((e,o)=>(r[o]?e[o]=t._combineValues(r[o],s[o]):e[o]=s[o],e),{});a[e]=Object.assign(r,n)}),a},_combineValues(e,t){let r,s=!1;return"object"!=typeof e&&(s=!0),(r=s?[e]:e).concat(t).join(" ")},copy(e,r){const s=e.data,o=Object.keys(s),n=t._normalizeSelection(e.select,r.length),a=r.map(e=>Object.assign({},e));return n.forEach(e=>{o.forEach(t=>{const r=a[e][t],o=s[t];a[e][o]=r})}),a},remove(e,r){const s=e.keys,o=t._normalizeSelection(e.select,r.length),n=r.map(e=>Object.assign({},e));return o.forEach(e=>{s.forEach(t=>{delete n[e][t]})}),n},hook:(e,r)=>r?r(e,t.modify):e,_findIfString:e=>"string"==typeof e[0],modify(e,r){let s=r.do;return t._findIfString(e)?(console.error(`Data operations require objects but have strings. Data: ${e}`),e):t[s](r,e)}};return t}},function(e,t,r){"use strict";const s=["draw","alterTemplate","alter","set","add","copy","remove","hook","block","save"];e.exports=function({showError:e,operation:t}){const r={interpret(e){const t={steps:[],arguments:[],hooks:[]},s=r._validate(e);return s.length>0?(t.errors=s,t):(e.forEach(e=>{t.steps.push(e.do),t.arguments.push(e),"hook"==e.do&&t.hooks.push(e.name),e.hook&&t.hooks.push(e.hook)}),t)},_validate(t){const r=[];return t instanceof Array?0==t.length?[e("emptyExtProcess")]:(t.forEach(t=>{let o=!1;t.do?(o=s.includes(t.do))||r.push(e("notaValidOperation",[t.do])):r.push(e("missingOperation"))}),r):[e("wrongExtProcess")]},_findIfString:e=>"string"==typeof e[0],_copyList(e){let t=e.length,r=[];for(;t--;)r[t]=e[t];return r},_parse(e){try{return JSON.parse(e)}catch(e){return!1}},_setupDrawDependencies:(e,t,r,s,o)=>({template:r,data:s,sharedData:e.data,htmlAttributes:e.config.htmlAttributes,missField:t.missField||!1,missData:t.missData||!1,hookFn:o}),_getTemplate(e,t,r){let s={},o=t[e],n=r[e]||t[e].placeholders,a=Object.keys(n);return s.tpl=o.tpl.map(e=>e),s.spaces=Object.assign({},o.spaces),s.placeholders={},a.forEach(e=>{s.placeholders[e]=n[e].map(e=>e)}),s},run(s,o,n){let a=this,c=a.templates,i=o,l=r._findIfString(i),p=r._getTemplate,u=r._setupDrawDependencies,d={};return s.steps.forEach((h,f)=>{const m=s.arguments[f];let b,g=m.watchHook&&n[m.watchHook]||!1,k=[];switch(h){case"draw":b=m.tpl,l&&console.warn(e("dataExpectObject",`Step "draw" with template "${b}"`));const s=n&&n[m.hook]||!1,f=!(null==m.as),y=m.space||" ";if(g)o.forEach(e=>{let[r,o]=g(e,b),n=p(o,c,d),i={};r instanceof Array||(r=[r]),i=u(a,m,n,r,s),k=k.concat(t[h](i))}),k=[k.join(y)];else{const e=p(b,c,d),r=u(a,m,e,i,s);k=t[h](r)}f?i=i.reduce((e,t,r)=>(t[m.as]=k[r],e.push(t),e),[]):(i=k,l=!0);break;case"block":if(!l)return void console.error(e("blockExpectString",JSON.stringify(i)));const _=m.space||"";if(i=t[h](i,_),m.name){let e={},t=m.method||"add";e[`block/${m.name}`]=i.join(""),a.insertData(e,t)}break;case"add":i=t[h](m,i);break;case"alterTemplate":b=m.tpl;const E=c[b];d[b]=t[h](m,E.placeholders);break;case"set":i=t[h](m,i),l=!1;break;case"hook":let O=t[h](i,n[m.name]);i=O instanceof Array?O:[O],l=r._findIfString(i);break;case"save":const j="block"!=m.as?m.name:`block/${m.name}`;let v={},w=m.method||"add";switch(m.as){case"block":case"data":v[j]=i.join(""),a.insertData(v,w);break;case"template":v[j]=i[0],a.insertTemplate(v,w);break;case"process":let t=r._parse(i[0]);t?a.insertProcess(t,j):console.error(e("invalidJSON",i[0]));break;default:return void console.error(e("invalidStorageName",m.as))}}}),i}};return r}},function(e,t){e.exports=function({help:e,templateTools:t,showError:r}){const s=t.str2intTemplate,o=t.load_interpretTemplate(s),n={insert(e,t="add"){let r=this;return Object.keys(e).forEach(s=>{const n=!!r.templates[s];n&&"add"==t||(n||"update"!=t)&&(n&&"heap"==t?r.templates[s]+=o(e[s]):r.templates[s]=o(e[s]))}),r},insertLib(t,s,o="add"){let a=this;return Object.keys(t).forEach(c=>{const i={},l=`${s}/${c}`;e._isWritingForbidden(a,"templates",l)?console.error(r("overwriteTemplate")):(i[l]=t[c],n.insert.call(a,i,o))}),a},rename(e){const t=this,s=Object.keys(e),o=t.config.overwriteTemplates;return s.forEach(s=>{if(!t.templates[s])return;const n=e[s];!t.templates[n]||o?(t.templates[n]=t.templates[s],delete t.templates[s]):console.error(r("overwriteTemplate"))}),t},remove(e){const t=this;let r;return(r=e instanceof Array?e:Object.keys(arguments).map(e=>arguments[e])).forEach(e=>delete t.templates[e]),t},get(e){const t=this.templates;let r;return(r=e instanceof Array?e:Object.keys(arguments).map(e=>arguments[e])).reduce((e,r)=>(t[r]?e[r]=t[r].tpl.join(""):e[r]="",e),{})},getLib(t){let r;return r=null==t?null:t instanceof Array?t:Object.keys(arguments).map(e=>arguments[e]),e._extractLib(this.templates,r)},getPlaceholders(e){const t=this.templates[e];return t?Object.keys(t.placeholders):[]}};return n}},function(e,t){e.exports=function({help:e,showError:t}){return{insert(t,r="add"){const s=this,o=e._flatten(t);return Object.keys(o).forEach(e=>{const t=!!s.data[e];t&&"add"==r||(t||"update"!=r)&&(t&&"heap"==r?s.data[e]+=o[e]:s.data[e]=o[e])}),s},insertLib(t,r,s="add"){const o=this,n=e._flatten(t);return Object.keys(n).forEach(e=>{const t=`${r}/${e}`,a=o.data[t];a&&"add"==s||(a||"update"!=s)&&(a&&"heap"==s?o.data[t]+=n[e]:o.data[t]=n[e])}),o},rename(e){const r=this,s=Object.keys(e),o=r.config.overwriteData;return s.forEach(s=>{if(!r.data[s])return;const n=e[s];!r.data[n]||o?(r.data[n]=r.data[s],delete r.data[s]):console.error(t("overwriteData",n))}),r},remove(e){const t=this;let r;return(r=e instanceof Array?e:Object.keys(arguments).map(e=>arguments[e])).forEach(e=>delete t.data[e]),t},getBlock(e){const t=this;let r=[];return(r=e instanceof Array?e:Object.keys(arguments).map(e=>arguments[e])).reduce((e,r)=>e+=t.data[`block/${r}`]?t.data[`block/${r}`]:"","")}}}},function(e,t,r){"use strict";e.exports=function({help:e,showError:t,processTools:r}){const s={insert(s,o){if(!e._isWritingForbidden(this,"processes",o))return this.processes[o]=r.interpret(s),this;console.error(t("overwriteProcess",o))},insertLib(e,t){return Object.keys(e).forEach(r=>{const o=t?`${t}/${r}`:r;let n;e[r]instanceof Array&&(n=[].concat(e[r]),s.insert.call(this,n,o))}),this},mix(r,s){const o=this.processes;let n={};if(!e._isWritingForbidden(this,"processes",s))return n.steps=[],n.arguments=[],n.hooks=[],r.forEach(e=>{if(!o[e])return;const t=o[e],r=t.hooks.map(t=>`${e}/${t}`),s=t.arguments.map(t=>"hook"!=t.do?t:{do:"hook",name:`${e}/${t.name}`});n.steps=n.steps.concat(t.steps),n.arguments=n.arguments.concat(s),n.hooks=n.hooks.concat(r)}),this.processes[s]=n,this;console.error(t("overwriteProcess",s))},getLib(e){const t=this,r=Object.keys(t.processes),s=!e;return r.reduce((r,o)=>{if(s)r[o]=t.processes[o].arguments;else if(o.includes(e)){const e=o.split("/");e.shift(),r[e.join("/")]=t.processes[o].arguments}return r},{})},rename(e){const r=this,s=Object.keys(e),o=r.config.overwriteProcesses;return s.forEach(s=>{if(!r.processes[s])return;const n=e[s];!r.processes[n]||o?(r.processes[n]=r.processes[s],delete r.processes[s]):console.error(t("overwriteProcess",n))}),r},remove(e){const t=this;let r;return(r=e instanceof Array?e:Object.keys(arguments).map(e=>arguments[e])).forEach(e=>delete t.processes[e]),t},getHooks(e){return this.processes.hasOwnProperty(e)?this.processes[e].hooks.reduce((e,t)=>(e[t]=void 0,e),{}):{}},run(t,s,o){t instanceof Array||(t=[t]);let n,a=t.reduce((t,r)=>{const s=e._validateProcess(this,r);return t.concat(s)},[]);if(n=null==s?[{}]:s instanceof Array?s:[s],0==a.length){let e=n;return t.forEach(t=>{e=r.run.call(this,this.processes[t],e,o)}),e}return console.error(a),a}};return s}}]);